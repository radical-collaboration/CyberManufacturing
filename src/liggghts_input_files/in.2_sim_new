 #This the restart input file for the DEM LIGGGHTS simulation




modify_timing      on
atom_style         granular
atom_modify        map array
boundary           f f f
newton             off
communicate        single vel yes
units              si
region             reg block -0.01 0.450 -0.150 0.150 -0.080 0.100
processors         * * *
create_box         17 reg
neighbor           0.0005 bin
neigh_modify       delay 0 check yes page 100000 one 30000
timestep           5e-7
fix                gravi all gravity 9.81 vector 0.0 -1.0 0.0


pair_style         gran model hertz tangential history
pair_coeff         * *


# Material properties required for new pair styles


fix                m1 all property/global youngsModulus peratomtype 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 8000000.000000 990000000.000000 
fix                m2 all property/global poissonsRatio peratomtype 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 0.200000 
fix                m3 all property/global coefficientRestitution peratomtypepair 17 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 0.400000 
fix                m4 all property/global coefficientFriction peratomtypepair 17 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 0.500000 
fix                m5 all property/global coefficientRollingFriction peratomtypepair 17 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 0.020000 




# Cad import and meshing
fix                cad1 all mesh/surface file impeller_coarse.stl element_exclusion_list read impeller heal auto_remove_duplicates precision 1e-9 type 17 scale 1e-3 curvature 1.0e-10
fix                cad2 all mesh/surface file shell_closed.stl element_exclusion_list read shell heal auto_remove_duplicates precision 1e-9 type 17 scale 1e-3  curvature 1.0e-10


fix                granulator all wall/gran model hertz tangential history mesh n_meshes 2 meshes cad2 cad1


#Rotating the impeller
variable           w equal -2000
fix                movecad1 all move/mesh mesh cad1 rotate/variable origin 0.193 0.00 0.00 axis 1. 0. 0. omega v_w


#Region and insertion
region             factory1 block 0.007 0.047 0.04 0.06 -0.02 0.02 units box


# Grouping
group              type1_ type 1
group              type2_ type 2
group              type3_ type 3
group              type4_ type 4
group              type5_ type 5
group              type6_ type 6
group              type7_ type 7
group              type8_ type 8
group              type9_ type 9
group              type10_ type 10
group              type11_ type 11
group              type12_ type 12
group              type13_ type 13
group              type14_ type 14
group              type15_ type 15
group              type16_ type 16




# Particle Specification
fix                pts1 type1_ particletemplate/sphere 89261 atom_type 1 density constant 500 radius constant 0.002000
fix                pts2 type2_ particletemplate/sphere 39623 atom_type 2 density constant 500 radius constant 0.002000
fix                pts3 type3_ particletemplate/sphere 41539 atom_type 3 density constant 500 radius constant 0.002000
fix                pts4 type4_ particletemplate/sphere 17959 atom_type 4 density constant 500 radius constant 0.002000
fix                pts5 type5_ particletemplate/sphere 75307 atom_type 5 density constant 500 radius constant 0.002000
fix                pts6 type6_ particletemplate/sphere 12347 atom_type 6 density constant 500 radius constant 0.002000
fix                pts7 type7_ particletemplate/sphere 26927 atom_type 7 density constant 500 radius constant 0.002000
fix                pts8 type8_ particletemplate/sphere 86501 atom_type 8 density constant 500 radius constant 0.002000
fix                pts9 type9_ particletemplate/sphere 52081 atom_type 9 density constant 500 radius constant 0.002000
fix                pts10 type10_ particletemplate/sphere 72337 atom_type 10 density constant 500 radius constant 0.002000
fix                pts11 type11_ particletemplate/sphere 58067 atom_type 11 density constant 500 radius constant 0.002000
fix                pts12 type12_ particletemplate/sphere 34807 atom_type 12 density constant 500 radius constant 0.002000
fix                pts13 type13_ particletemplate/sphere 80363 atom_type 13 density constant 500 radius constant 0.002000
fix                pts14 type14_ particletemplate/sphere 60271 atom_type 14 density constant 500 radius constant 0.002000
fix                pts15 type15_ particletemplate/sphere 38153 atom_type 15 density constant 500 radius constant 0.002000
fix                pts16 type16_ particletemplate/sphere 64301 atom_type 16 density constant 500 radius constant 0.002000





#Partcle Distribution for insertion
fix                pdd1 all particledistribution/discrete 827417 16 pts1 0.15479015694 pts2 0.151413052596 pts3 0.141717420629 pts4 0.126917968661 pts5 0.108758431392 pts6 0.0891749156399 pts7 0.069962034205 pts8 0.052519683363 pts9 0.037724345965 pts10 0.0259275385311 pts11 0.0170506447887 pts12 0.0107290254359 pts13 0.00645980922251 pts14 0.00372150887276 pts15 0.00205143789959 pts16 0.00108202585895 




# Particle insertion
fix                ins1 all insert/rate/region seed 106417 distributiontemplate pdd1 nparticles INF massrate 0.004167 insert_every 10000 overlapcheck yes vel constant 0.0 -1.0 -0.0001 region factory1 ntry_mc 1000



# Calculating particle wall collisions
compute            pwc all wall/gran/local id vel force contactArea delta # Calculate particle wall collision
compute            ppc all pair/gran/local id vel force contactArea delta # Calculate particle-particle collision
# Apply nve integration to all particles that are inserted as single particles
fix                integ all nve/sphere



# Collecting particle collision data 
fix                fppacc all property/atom fppacc scalar yes yes yes 0


# Collecting particle-particle collision data
compute            cc_1 type1_ contact/atom
compute            cc_2 type2_ contact/atom
compute            cc_3 type3_ contact/atom
compute            cc_4 type4_ contact/atom
compute            cc_5 type5_ contact/atom
compute            cc_6 type6_ contact/atom
compute            cc_7 type7_ contact/atom
compute            cc_8 type8_ contact/atom
compute            cc_9 type9_ contact/atom
compute            cc_10 type10_ contact/atom
compute            cc_11 type11_ contact/atom
compute            cc_12 type12_ contact/atom
compute            cc_13 type13_ contact/atom
compute            cc_14 type14_ contact/atom
compute            cc_15 type15_ contact/atom
compute            cc_16 type16_ contact/atom




# Dump files configurationn
run                1
dump               myDump  all custom 50000 post/dump*.atom id type x y z ix iy iz vx vy vz fx fy fz c_cc_1 c_cc_2 c_cc_3 c_cc_4 c_cc_5 c_cc_6 c_cc_7 c_cc_8 c_cc_9 c_cc_10 c_cc_11 c_cc_12 c_cc_13 c_cc_14 c_cc_15 c_cc_16 f_fppacc radius
dump               myDump2 all local 50000 post/coll*.atom c_pwc[1] c_pwc[2] c_pwc[3]
dump               myDump3 all local 50000 post/pcoll*.atom c_ppc[1] c_ppc[2] c_ppc[3] c_ppc[4]
dump               dumpstl1 all mesh/stl 50000 post/dump*.stl
restart            50000 restart/granulator.*.restart





# End run
run                100001 upto

# Unfixing data points to facilitate restart
unfix              ins1
unfix              pts2
unfix              pts3
unfix              pts4
unfix              pts5
unfix              pts6
unfix              pts7
unfix              pts8
unfix              pts9
unfix              pts10
unfix              pts11
unfix              pts12
unfix              pts13
unfix              pts14
unfix              pts15
unfix              pts16
