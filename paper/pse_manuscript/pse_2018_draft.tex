% ==============================================================================================
% 2010-11-05 Preisig, H A       ; NTNU
% 2011-12-15  ditto             ; adapted for PSE 11
%                               ; put all the heading info into the style file
% 2012-01-04  ditto             ; Reference section title fixed -- integrated into style file
%                               ; changed sequence: first bibliography then pse style
%                               ;  pse style redefines reference listing superseding natlib def
%                               ;  and simplified by moving reference style loading into pse.sty
% 2014-09-04  ditto             ; reverted to standard LaTeX fonts
%                               ; issues - measures do not correspond with manual. 
%                               ; There is a cm missing 13.5 textwidth gives 12.5 texwidth ???
% 2015-10-14 Zinser, A          ; adapted to ESCAPE 26
% ==============================================================================================

\documentclass[fleqn,twoside,10pt]{article}

%% bibliography must be before escape styles
\usepackage{natbib}
\bibliographystyle{elsart-harv}

%% Escape/PSE styles
\usepackage{left_eq}   % To get the equation left aligned, this is ugly but required :-)
\usepackage{pse2018}  % Stylefile from Escape


%%% >>>>>>>>>>>>>>> use your own GRAPHICS configuration <<<<<<<<<<<<<<<<<<<<<<<
\usepackage{pstricks, pst-plot}	% pstricks
\usepackage{graphicx} % enables import of various formats
\usepackage{wrapfig}  % enables floating wrapped figures
\usepackage[figuresright]{rotating}
\usepackage{amsmath}
\usepackage[font=sf, labelfont={sf,bf}, margin=0cm]{caption}
\usepackage[inline]{enumitem}
\usepackage{epstopdf}   
%\usepackage[margin=1in]{geometry}
\usepackage{lineno}
\usepackage{placeins}
\usepackage{subcaption}
%\usepackage[usenames,dvipsnames]{color}
%\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{textcomp}
\usepackage{graphicx}
\usepackage{tabulary}

%% math packages
\usepackage{amsmath}
\usepackage{amssymb}

%% >>>>>>>>>>>>>>>> user definitions BIBLIOGRAPHY & DEFS <<<<<<<<<<<<<<<<<<<<<<<<


%% personal styles and definitions
%\usepackage{mystyle}
%\def\mydefs{defs}
\usepackage[english]{babel}
\usepackage{blindtext}


% ================================================================================
\title{Parallel, multi-scale, mechanistic model for high shear granulation using
coupled DEM-PBM models on high performance computing systems.}
%
 \author[a]{Chaitanya Sampat}
 \author[a]{Yukteshwar Baranwal}
 \author[b]{Ioannis Paraskevakos}
 \author[b]{Shantenu Jha}
 \author[a]{Marianthi Ierapetritou}
 \author[a,*]{Rohit Ramachandran}
 \affil[a]{Department of Chemical and Biochemical Engineering, Rutgers University, Piscataway, NJ-08901, USA}
 \affil[b]{Electric and Computer Engineering, Rutgers University, Piscataway, NJ-08901, USA}
 \email{*rohitrr@soe.rutgers.edu}
 
 \HeaderTitle{Parallel, multi-scale, mechanistic model for high shear granulation using
coupled DEM â€“ PBM models on high performance computing systems.}
 \HeaderAuthor{C. Sampat et al.}

% ==================================== title ====================================

\begin{document}

\maketitle             % make title page with abstract and keywords
\thispagestyle{empty}  % first page has a different format

% ================================================================================

\begin{abstract}
A multiscale model combines the computational efficiency of a macro-scale model and the
accuracy of a micro-scale model. It is preferred over a fully micro-scale model for its speed advantages while maintaining the physics 
of the problem. A less accurate way to perform such a simulation is touse data from a precomputed microscale model in a macroscale 
model. With the current cyberinfrastructure resources available, using more computationally intensive and concurrent multiscale models 
are morefeasible. This study proposes to use Discrete Element Method (DEM), a microscale model, and a Population Balance Model (PBM), 
a macroscale model, in a concurrent manner to model the granulation process of a pharmaceutical product inside a high shear 
granulator. The granulation between the components of a pharmaceutical blend is governed by the collision in between the particles. 
This leads to increase in their size, due to physical bonds in between them. The DEM provides the collision data while the PBM helps 
in predicting the macroscale phenomena like aggregation and breakage. This work attempts to couple these two models using a controller 
program, which triggers the DEM first, to give initial seed data to run the PBM. Then, the controller uses the data generated from the 
PBM continuously to determine the change in the physical properties and trigger the DEM from its last known state. The controller does 
the same with the DEM data to trigger the PBM. This occurs iteratively until a steady state is reached. A workflow diagram of the 
procedure followed is provided in Figure 1. The execution of each of the components is governed by a multilevel job scheduler which 
allocates resources rather than waiting for each simulation to run on a
normal job scheduler on a cluster. The DEM is parallelized using Message Parsing Interface (MPI) while the PBM is parallelized using a 
faster hybrid approach which is a combination of both MPI and Open Multi-Processing (OMP). Since the DEM is computationally heavy, an 
algorithm is developed to utilize the idle cores during the PBM execution to run multiple instances of the PBM such that parameter 
estimation of the kernels of the PBM occurs on the fly as well. This method of using shorter bursts of each simulation led to faster 
simulation times as well as a more accurate model of the high shear granulator. The Quality by Design (QbD) approach is addressed 
using such a modelling framework and it also helps us understand the
granulation process in a quantitative as well as in a mechanistic manner.
\end{abstract}
\Keywords{Multi-scale Model, Population Balance Model, Discrete Element Method, High-performance computing, MPI}

% ==================================== body  =====================================

\section{Introduction}
%The domain for tradional chemical engineering process modelling spans for a broad range of
%time and length scales \cite{ingram2004apjce} . Characteristic lengths and time scales of 
%atomistic simulation are commonly used are in the order of $10^{-12}$ $m$ and $10^{-9}$ $s$ 
%respectively. These scales extend to thousands of kilometers ($10^{9}$ $m$) and years 
%($10^9$ $s$) for life-cycle analysis and environmental simulations. Most of the processes
%are inherently connected, but with the limitations of older computation resources they have
%only been studied in isolation to each other.  But with the current

Particulate materials are products or intermidiates of around $60\%$ of the chemical industry\citep{ingram2005}.
The modelling of these particulate processes pose a challenge when compared to modelling if uniform liquid
systems. These solid systems usually comprise of solids which co-exist with various sizes and shape configuration,
which have a large effect on the final composition and the performance of the product. This variation in the 
configuration of the product is unaccepatable by the pharmaceutical industry. It could lead to differences in the 
dissolution rates and bioavailability of the product thus, affecting the quality of the product. The unit process 
that helps control the size of a granule of the powder in the pharmaceutical product is granulation. During this 
unit operation, fine powders are converted to the  larger particles by the process of aggregation. This occurs
due to addition of a liquid binder, making the particles agglomerate into larger granules. This process is also 
referred to as wet granulation as a liquid binder is added. Due to high restrictions set by the Food and Drug 
Administration (FDA) these products undergo various batch rejections or have high recycle ratios\citep{sen2014}. 
One of the major aims of the industry currently is to reduce this waste, thus creating a need for better 
modelling of this process.

The most popular way to model the granulation process is to use a population balance model (PBM). This model 
tracks the number of particles with certain set of charactersitics such as size, porosity and liquid content. 
It also takes into account the changes that may occur in these properties due to growth, breakage, consolidation, 
and other phenomena. This model is discussed in more detail in section \ref{sec_mthds_PBM}. PBM fails to account 
for the particle level data, thus being inaccurate at times. This particle level data needed to improve the PBM 
can be obtained from discrete element methods (DEM). DEM help obtain the velocity of each particle and the 
number of times it collides with other particles by solving the Newton's laws of motion. This information 
is vital to the PBM as it helps develop a more accurate model with a higher physical significance. As these 
methods are complementary to each other, they are usually coupled whille building a model for the granulation 
process. These processes can be coupled serially like in \textbf{(cite current paper here)} or in parallel as 
discussed in this work. DEM is always executed at initiation and the particle level data is then transferred to 
the PBM. The DEM simulation is computationally very high as it needs to solve large amounts of simultaneous 
equations at every time step. The parallel execution of this type of coupling requires various instances 
of simulation of each of these models to be initiated, requiring high computational power. The most efficient way 
to make these simulations run faster is to take advantage of large number of CPU cores present on modern day 
high-performance computing systems (HPCs / supercomputers).

This work focusses on the building of physically accurate model for a high shear granulator. Section \ref{methods} 
discusses the model equation used and the method of parallelization implemented on the PBM and DEM to enable them to 
run on various cores of HPCs. The resulting particle properties from the coupling and the speed improvements 
achieved when the number of cores used for the simulation are changed, is discussed in section \ref{results}.

%\begin{itemize}
%\item Talk about pharmaceutical processes
%\item Talk about DEM and PBM
%\item Coupling and its importance
%\item Advantages of using HPC
%\end{itemize}

\section{Methods}
\label{methods}

\subsection{Population Balance Model (PBM) development}
\label{sec_mthds_PBM}

\begin{itemize}
\item Aggregation
\item Breakage
\end{itemize}
\subsection{Discrete Element Model (DEM) setup}
\subsection{PBM parallelization technique}
\subsection{Controller development}
Explain the controller configuration and how it works
\section{Results}
\label{results}
Discuss how many instances of the simulation of each occured
\subsection{Scaling results}
Cores used for DEM and PBM and how scaling occured
\subsection{Improved results over one way coupling}
Better d50 plots particle count
\section{Conclusion}

% ================================ references ===================================
%% References 

\bibliography{pse2018_psl}
\end{document}
% ================================== end =========================================